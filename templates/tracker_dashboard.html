<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Tracker | AutoPro AI</title>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        :root { --primary: #6c5ce7; --bg: #f8fafc; }
        body { background: var(--bg); font-family: 'Outfit', sans-serif; padding: 40px; margin: 0; }
        .container { max-width: 1100px; margin: auto; background: white; padding: 30px; border-radius: 25px; box-shadow: 0 10px 40px rgba(0,0,0,0.05); }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { padding: 15px; text-align: left; border-bottom: 1px solid #f1f5f9; }
        th { color: #64748b; font-size: 13px; text-transform: uppercase; }
        .badge { background: #e0e7ff; color: #4338ca; padding: 5px 12px; border-radius: 20px; font-size: 11px; font-weight: 700; }
        .btn-view { background: var(--primary); color: white; border: none; padding: 8px 16px; border-radius: 10px; cursor: pointer; font-weight: 700; transition: 0.3s; }
        .btn-view:hover { opacity: 0.9; transform: scale(1.05); }
        
        /* Modal Popup */
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); justify-content: center; align-items: center; z-index: 1000; }
        .modal-box { background: white; padding: 30px; border-radius: 25px; width: 90%; max-width: 550px; }
        .modal-body { background: #f1f5f9; padding: 20px; border-radius: 15px; margin: 20px 0; white-space: pre-wrap; max-height: 300px; overflow-y: auto; color: #334155; line-height: 1.5; }
        .close-btn { background: #cbd5e1; border: none; padding: 10px 20px; border-radius: 10px; cursor: pointer; font-weight: 700; width: 100%; }
    </style>
</head>
<body>


<div class="container">
    <h1>All-in-One <span style="color:var(--primary)">Activity Tracker</span> ðŸ“Š</h1>
    <table>
        <thead>
            <tr>
                <th>Mode</th>
                <th>Item / Job Name</th>
                <th>Sent To (Company/Person)</th> 
                <th>Date</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody>
            {% for act in activities %}
            <tr>
                <td><span class="badge">{{ act.mode }}</span></td>
                <td><strong>{{ act.job_title }}</strong></td>
                <td style="color: #4338ca; font-weight: 500;">
                    {{ act.recipient if act.recipient else '---' }}
                </td>
                <td>{{ act.date_submitted.strftime('%d %b, %Y') }}</td>
                <td>
                    <button class="btn-view" onclick="openView('{{ act.job_title }}', `{{ act.content }}`)">VIEW CONTENT</button>
                </td>
            </tr>
            {% else %}
            <tr><td colspan="5" style="text-align:center; padding:40px; color:#94a3b8;">No records found. Start generating!</td></tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<div id="viewModal" class="modal">
    <div class="modal-box">
        <h2 id="mTitle" style="margin:0; color:#1e293b;">Preview</h2>
        <div class="modal-body" id="mBody"></div>
        <button class="close-btn" onclick="document.getElementById('viewModal').style.display='none'">Close Preview</button>
    </div>
</div>

<script>
    function openView(title, content) {
        document.getElementById('mTitle').innerText = title;
        document.getElementById('mBody').innerText = content;
        document.getElementById('viewModal').style.display = 'flex';
    }

    // Close modal when clicking outside the box
    window.onclick = function(event) {
        let modal = document.getElementById('viewModal');
        if (event.target == modal) {
            modal.style.display = "none";
        }
    }
</script>

</body>
</html>